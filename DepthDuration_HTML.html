<!DOCTYPE html>
<html>
	<head>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
		<link rel="stylesheet" href="DepthDuration_CSS.css">
		<script src="DepthDuration_JS.js"></script>
	</head>

	<body>
		<!-- This calls the php function, and on submit, the page refreshes (unless otherwise specified in php) -->
		<form name="saveData" id="saveData" action="saveFile.php" method="post">
			<!-- Any variables you want to pass to the php have to be here -->
			<input type="hidden" name="experimentData" id="experimentData"> <!-- this value should be your data array after JSON.stringify(data)  -->
			<input type="hidden" name="subjID" id="subjID" value="test">
			<input type="hidden" name="startTime" id="startTime" value="test">
			<input type="hidden" name="startDate" id="startDate" value="test">
			<input type="hidden" name="completedTrialsNum" id="completedTrialsNum" value=0>
		</form>
		
		<!-- instructions -->
		<div id="startingInstructions" class="instructions">
			<div class="hidden">
				<script type="text/javascript">
				var seq_filepath = 'seq_sequence_AF.json'

				var stim_seq = $.ajax({ // loads in stimulus sequence from server
                				url: seq_filepath,
                				method: 'GET',
                				dataType: 'json',
                				data: JSON.stringify(),
                				success: function (data) {
                    			stim_seq = data;
                    			preload(practice_seq, stim_seq); // calls function to preload all scene images 
                    			preloadMasks(practice_seq, stim_seq); // calls function to preload all mask images 
                },
            });
				var images = new Array()
				function preload(practice_seq, stim_seq) {
					for (var i = 0; i < practice_seq.length; i++) { // loops through all trials in practice sequence
					images[i] = new Image() // constructer that creates an empty image object
					images[i].src = practice_seq[i].image_path_target // sets the image source for the object 
					}

					for (var i = 0; i < stim_seq.length; i++) { // loops through all experimental trials in sequence 
					images[i] = new Image()
					images[i].src = stim_seq[i].image_path_target
					}
				}

				var masks = new Array()
				function preloadMasks(practice_seq, stim_seq) {
					for (var j = 0; j < practice_seq.length; j++) { // loops through all trials in practice sequence
					masks[j] = new Image()
					masks[j].src = practice_seq[j].mask_path
					}

					for (var j = 0; j < stim_seq.length; j++) { // loops through all experimental trials in sequence 
					masks[j] = new Image()
					masks[j].src = stim_seq[j].mask_path
					}
				}
				
				</script>
			</div>
		</div>

		<div id ="getConsent" class="instructions">
		</div>

		<div id ="Instructions2" class="instructions">
			<h1>Instructions</h1>
			<p>In the following experiment, you will be asked to look at pictures of everyday scenes and make distance judgments of objects in them.</p>
		    
		    <p>For each trial, you will see an image with a red, black, and white circle (the target) displayed over an object in the scene, like in the example below. You will imagine yourself standing in the scene and make a judgment of how far away the object directly underneath the target is from your toes. For example, in the image below, you would be judging how far away the brown stripe is from you, as if you were physically standing in the scene. </p>

	        <p>The target will only appear in the vertical center of the image, directly in your line of view if you were standing in the middle of the scene.</p>

			<img src="example.png" />
		</div>

		<div id = "FinalInstructions" class="instructions">
		</div>

		<div id = "getUnits" class="instructions">
		</div>


		<div id="lastBlockInstructions" class="instructions"> 
		</div>


		<!-- buttons -->

		<div id="startConsentButton" class="buttonDivPg1">
			<a href="#" id="startConsentText" onclick="showConsent()">Next</a>
		</div>

		<div id="Instructions2Button" class="buttonDivPg2">
			<a href="#" id="Instructions2Text" onclick="nextInstructions()">Agree</a>
		</div>

		<div id="FinalInstructionsButton" class="buttonDivPg3">
			<a href="#" id="FinalInstructionsText" onclick="finalInstructions()">Next</a>
		</div>

		<div id="getUnitsButton" class = "buttonDivPg4">
			<a href="#" id="getUnitsText" onclick="getUnits()">Begin</a>
		</div>

		<div id="metersSelectedButton" class = "metersButtonDiv">
			<a href="#" id="metersSelectedText" onclick="recordUnitsMeters()">Meters</a>
		</div>

		<div id="feetSelectedButton" class = "feetButtonDiv">
			<a href="#" id="feetSelectedText" onclick="recordUnitsFeet()">Feet</a>
		</div>

		<div id="startPracticeButton" class = "startPracticeButtonDiv">
			<a href="#" id="startPracticeText" onclick="startPractice()">Start Practice</a>
		</div>

		<div id="startTrialsButton" class = "startTrialsButtonDiv">
			<a href="#" id="startTrialsText" onclick="runTrial()">Start</a>
		</div>

		<div id="revealCodeButton" class="buttonDiv">
			<a href="#" id="revealCodeText" type onclick="endExperiment()">Reveal Code</a>
		</div>


		<!-- div to preload all images to prevent lag -->
		<div id="preload" class="preload">
		</div>

		<div id="preload_masks" class="preload_masks">
		</div>

		<div id="preloadExperiment" class="preloadExperiment">
		</div>

		<div id="preload_masksExperiment" class="preload_masksExperiment">
		</div>

		<!-- start experiment -->
		<div id="start_trials" class="startTrialsDiv">
			<p>You have completed the practice trials!</p> 
			<p>Click 'START' to continue to the experiment.</p>
		</div>

		<!-- end experiment -->
		<div id="lastBlockInstructions" class="instructions">
		</div>


		<!-- fixations -->
		<div id="fixation" class="fixationDiv">
			<img id = "fixation_image" src="" width=750>
		</div>

		<!-- mask -->
		<div id="mask" class="maskDiv">
			<img id= "mask_image" src="" width=750>
		</div>

		<div id="maskExp" class="maskDiv">
			<img id= "mask_image" src="" width=750>
		</div>

		<!-- Scene (w/ target) -->
		<div id="scene" class="sceneDiv">
			<img id= "scene_image" src="" width=750>
		</div>

		<div id="sceneExp" class="sceneDiv">
			<img id= "scene_image" src="" width=750>
		</div>

		<div id="response" class="responseDiv">
			<h1> How far away is the target? </h1>
			<input id="numb" autocomplete="off" onfocus="this.value=''" value="">

			<button type="button" onfocus="this.value=''" value="" onclick="validateForm();">Submit</button>
			<p id="feedback"></p>
			<script>
				
			function validateForm() {
			  var estimate, text;

			 // Get the value of the input field with id="numb"
			 estimate = document.getElementById("numb").value;

			  // If x is Not a Number or less than zero
			  if (isNaN(estimate) || estimate < 0 || estimate.length == 0) {
			    text = "Please enter a number greater than or equal to zero (decimals allowed)";
			  } 
			  else {
			  	text=""
			  	if (practiced == false){
			  		practice_trial ++; 
			  		startPractice();
			  		document.getElementById("numb").value = ""
			  	}
			  	else{
			  		trial ++;
			  		runTrial();
			  		document.getElementById("numb").value = ""

			  	}
			  	$(".responseDiv").hide()
			  }
			  document.getElementById("feedback").innerHTML = text;
			}
			</script>
		</div>
		
	</body>
</html> 